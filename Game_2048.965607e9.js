let e;function t(e){return Math.floor(Math.random()*e)}function l(e,t){return e.length===t.length&&e.every((e,l)=>e===t[l])}const r=new class{constructor(e){console.log(e)}moveRight(){this.moveHorizontally("right")}moveLeft(){this.moveHorizontally("left")}moveUp(){this.moveVertically("up")}moveDown(){this.moveVertically("down")}getScore(e){let t=document.querySelector(".game-score"),l=parseInt(t.innerHTML)||0;t.innerHTML=l+e}getState(){let e=document.querySelector("tbody").rows,t=[];for(let l=0;l<e.length;l++){t[l]=[];for(let r=0;r<e[l].cells.length;r++){let n=e[l].cells[r];t[l].push(parseInt(n.innerHTML)||0)}}return t}getStatus(){return this.hasWon()?"win":this.hasLose()?"lose":this.isPlaying()?"playing":this.isIdle()?"idle":void 0}setStatus(e){return e}hasWon(){let e=document.querySelector("tbody").rows;for(let t=0;t<e.length;t++){let l=e[t].cells;for(let e=0;e<l.length;e++)if(2048===parseInt(l[e].innerHTML))return!0}return!1}hasLose(){let e=document.querySelector("tbody").rows,t=[];for(let l=0;l<e.length;l++){t[l]=[];let r=e[l].cells;for(let e=0;e<r.length;e++)t[l][e]=parseInt(r[e].innerHTML)||0}for(let e=0;e<t.length;e++)for(let l=0;l<t[e].length;l++)if(0===t[e][l])return!1;for(let e=0;e<t.length;e++)for(let l=0;l<t[e].length-1;l++)if(t[e][l]===t[e][l+1])return!1;for(let e=0;e<t.length-1;e++)for(let l=0;l<t.length-1;l++)if(t[e][l]===t[e+1][l])return!1;return!0}isIdle(){let e=document.querySelectorAll("tbody td");for(let t=0;t<e.length;t++)if(parseInt(e[t].innerHTML)>0)return!1;return!0}isPlaying(){let e=this.isIdle(),t=this.hasLose(),l=this.hasWon();return!e&&!t&&!l}start(){let e,l,r=document.querySelector(".button.start");r.classList.add("restart"),r.classList.remove("start"),r.textContent="Restart";let n=Array.from(document.querySelectorAll(".field-cell")),o=new Set;for(;2!==o.size;)o=new Set([e=n[t(n.length)],l=n[t(n.length)]]);2===o.size&&(e.classList.add("field-cell--2"),e.innerHTML="2",l.classList.add("field-cell--2"),l.innerHTML="2");let s=document.querySelector(".message-start");s&&s.remove()}restart(){let e=document.querySelector(".button.restart");e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",Array.from(document.querySelectorAll(".field-cell")).forEach(e=>{e.className="field-cell",e.innerHTML=""});let t=document.querySelector(".lose-window");t&&t.remove();let l=document.querySelector(".win-window");l&&l.remove();let r=document.querySelector(".game-score");r&&(r.innerHTML="0"),this.setStatus("playing");let n=document.createElement("p");n.className="message message-start",n.innerHTML='Press "Start" to begin game. Good luck!',document.querySelector(".message-container").appendChild(n)}addNewCell(){let e=Array.from(document.querySelectorAll("tbody td")).filter(e=>""===e.textContent.trim());if(e.length>0){let l=e[t(e.length)],r=t(2);0===r?(l.innerHTML="2",l.classList.add("field-cell--2")):1===r&&(l.innerHTML="4",l.classList.add("field-cell--4"))}}moveHorizontally(e){let t=this.getState(),r=[],n=document.querySelector("tbody").rows,o=0,s=!1;for(let n=0;n<t.length;n++){let i=t[n].slice(),a=[...i];i=i.filter(e=>e>0);for(let e=0;e<i.length-1;e++)i[e]===i[e+1]&&(i[e]*=2,o+=i[e],s=!0,i[e+1]=0);for(i=i.filter(e=>e>0);4!==i.length;)"right"===e?i.unshift(0):"left"===e&&i.push(0);r.push(i),l(a,i)||(s=!0)}for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++)n[e].cells[t].innerHTML=r[e][t]>0?`${r[e][t]}`:"",n[e].cells[t].className="field-cell",r[e][t]>0&&n[e].cells[t].classList.add(`field-cell--${r[e][t]}`);this.getScore(o),s&&this.addNewCell()}moveVertically(e){let t=this.getState(),r=[],n=document.querySelector("tbody").rows,o=0,s=!1;for(let n=0;n<t[0].length;n++){let i=[];for(let e=0;e<t.length;e++)i.push(t[e][n]);let a=[...i=i.slice()];i=i.filter(e=>e>0);for(let e=0;e<i.length-1;e++)i[e]===i[e+1]&&(i[e]*=2,o+=i[e],s=!0,i[e+1]=0);for(i=i.filter(e=>e>0);4!==i.length;)"down"===e?i.unshift(0):"up"===e&&i.push(0);for(let e=0;e<t.length;e++)r[e]=r[e]||[],r[e][n]=i[e];l(a,i)||(s=!0)}for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++)n[e].cells[t].innerHTML=r[e][t]>0?`${r[e][t]}`:"",n[e].cells[t].className="field-cell",r[e][t]>0&&n[e].cells[t].classList.add(`field-cell--${r[e][t]}`);this.getScore(o),s&&this.addNewCell()}loseWindow(){let e=document.createElement("div");e.className="lose-window";let t=document.createElement("h2");t.textContent="You lose! Try again.",e.appendChild(t),document.body.appendChild(e)}winWindow(){let e=document.createElement("div");e.className="win-window";let t=document.createElement("h2");t.textContent="You won! Congratulation!.",e.appendChild(t),document.body.appendChild(e)}},n=document.querySelector(".button");function o(){clearInterval(e),e=setInterval(()=>{let t=r.getStatus();"win"===t?(r.winWindow(),clearInterval(e)):"lose"===t&&(r.loseWindow(),clearInterval(e))},100)}n&&n.addEventListener("click",()=>{n.classList.contains("start")?(r.start(),r.setStatus("playing"),o()):n.classList.contains("restart")&&(r.restart(),r.setStatus("idle"),o())}),document.addEventListener("keydown",e=>{r.isPlaying()&&("ArrowLeft"===e.key?r.moveLeft():"ArrowRight"===e.key?r.moveRight():"ArrowUp"===e.key?r.moveUp():"ArrowDown"===e.key&&r.moveDown())});
//# sourceMappingURL=Game_2048.965607e9.js.map
